<html><head><meta http-equiv="Content-type" content="text/html;charset=UTF-8"></meta></head><body>
<h1>Встраивание двоичных данных в исполняемый файл (программу на C)</h1>
<p>иногда нужно добавить данные в программу после компиляции. рассмотрим один из способов </p>
<p>так как значимые для загрузки исполняемго (exe-)файла данные находятся в начале файла, то данные можно записать в конец ехе-шника. после этого файл (в многих системах) будет успешно загружаться и выполняться.</p>
<p>возникает проблема, как эти данные найти из самого кода программы. хоть они и внутри исполняемого файла, тем не менее, многим пользователям может быть затруднительно их найти (на 2019 год - мне тоже) разбором этого файла.</p>
<p>как решим? - создадим в программе переменную-строку определенного вида, которую можно будет найти редактором или скриптом:</p>
<pre>	char c[] = "\n mysizeis 000000 \n";</pre>
<p>(полный исходник программы в data/embeddata1/main.c. это 8-ая строка)</p>
<p>после компиляции мы всегда сможем порыться (редактором) в ехе-файле и найти эту строку. в моём случае, это строка содержит размер программы до того, как в её хвост добавлены данные.</p>
<p>при запуске, программа прочитает эту измененную извне строку и поймёт, с какого места в хвосте её исполняемого файла лежат дописанные данные.</p>
<p>чтобы попробовать программу в работе, вам потребуется Unix-совместимая ОС. так же вам понадобится установленный в системе компилятор, make и Lua.</p>
<p>* перейдите в консоли/терминале в директорию `data/embeddata1`</p>
<p>* соберите проект командой `make`</p>
<p>* или можно сразу собрать и запустить командой `make run`</p>
<p>* программа отобразит содержимое `data.txt`</p>
<p>* можете отредактировать файл `data.txt`, перезапустить `make run` и убедиться, что уже новые данные встроены в программу.</p>
<br><br><br><br>
<p>больше статей можно найти на канале в Telegram: <a href='https://t.me/assistpc'>https://t.me/assistpc</a></p>
</body></html>
